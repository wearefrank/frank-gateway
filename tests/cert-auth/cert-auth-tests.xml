<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="528e6e0f-e550-453e-9784-f99d778b1aa1" activeEnvironment="Default" name="CertAuthTests" soapui-version="5.9.0" abortOnError="false" runType="SEQUENTIAL" resourceRoot="" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="com.eviware.soapui.impl.wsdl.actions.iface.tools.soapui.TestRunnerAction@values-local"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="Report Format(s)" value=""/>
  <con:entry key="Host:Port" value=""/>
  <con:entry key="Export JUnit Results" value="false"/>
  <con:entry key="Export All" value="false"/>
  <con:entry key="Save After" value="false"/>
  <con:entry key="Add Settings" value="false"/>
  <con:entry key="WSS Password Type" value=""/>
  <con:entry key="TestSuite" value="&lt;all>"/>
  <con:entry key="Endpoint" value=""/>
  <con:entry key="Select Report Type" value=""/>
  <con:entry key="System Properties" value=""/>
  <con:entry key="Password" value=""/>
  <con:entry key="Print Report" value="false"/>
  <con:entry key="Open Report" value="false"/>
  <con:entry key="Export JUnit Results with test properties" value="false"/>
  <con:entry key="Global Properties" value=""/>
  <con:entry key="Project Properties" value=""/>
  <con:entry key="Project Password" value=""/>
  <con:entry key="TestCase" value="&lt;all>"/>
  <con:entry key="Username" value=""/>
  <con:entry key="user-settings.xml Password" value=""/>
  <con:entry key="TestRunner Path" value=""/>
  <con:entry key="Environment" value="Default"/>
  <con:entry key="Coverage Report" value="false"/>
  <con:entry key="Enable UI" value="false"/>
  <con:entry key="Root Folder" value=""/>
  <con:entry key="Ignore Errors" value="false"/>
  <con:entry key="Domain" value=""/>
  <con:entry key="Tool Args" value=""/>
  <con:entry key="Save Project" value="false"/>
</xml-fragment>]]></con:setting>
  </con:settings>
  <con:interface xsi:type="con:RestService" id="b1925124-0120-4d42-a3b0-b13b453a929e" wadlVersion="http://wadl.dev.java.net/2009/02" name="cert-auth" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:description>Apisix plugin named cert-auth </con:description>
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart=""/>
    <con:endpoints>
      <con:endpoint>https://apisix</con:endpoint>
      <con:endpoint>https://localhost</con:endpoint>
    </con:endpoints>
    <con:resource name="MTLS with cn=ssl.bult.bz" path="/anything" id="abc06011-ea03-46b7-92d4-1f0ac1a2199d">
      <con:settings/>
      <con:parameters/>
      <con:method name="GET localhost/anything" id="eb3dae1b-1a92-4d66-b60e-9903bbf24fd6" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:any="https://localhost/anything">any:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/plain; charset=utf-8</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html; charset=utf-8</con:mediaType>
          <con:status>500</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="fb880d5d-498a-4e0a-b93a-f7b0caae8ce4" mediaType="application/json" sslKeystore="BULT_certuser.p12">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">
              &lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://127.0.0.1.nip.io:9443</con:endpoint>
          <con:request/>
          <con:originalUri>https://localhost/anything</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>Basic</con:selectedAuthProfile>
            <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
            <con:preemptive>false</con:preemptive>
            <con:authType>Global HTTP Settings</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
          <con:parameterOrder/>
        </con:request>
      </con:method>
      <con:method name="Method 2" id="31d595fc-d2a0-4c4b-ad8a-a8ec049e0f86" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/plain; charset=utf-8</con:mediaType>
          <con:status>403 404</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:head="https://apisix.127.0.0.1.nip.io/headers">head:Response</con:element>
        </con:representation>
        <con:request name="Request 1" id="04d146d8-9143-4977-9cef-3f7defb17893" mediaType="application/json" sslKeystore="BULT_certuser.p12">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">
              &lt;xml-fragment/></con:setting>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@strip-whitespaces">false</con:setting>
          </con:settings>
          <con:endpoint>https://127.0.0.1.nip.io:9443</con:endpoint>
          <con:request/>
          <con:originalUri>https://apisix.127.0.0.1.nip.io/headers</con:originalUri>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
          <con:parameterOrder/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="MTLS with cn=CLIENT" path="/headers" id="bf88d5ba-754d-4c30-b3d1-78cb585db840">
      <con:settings/>
      <con:parameters/>
      <con:method name="Method 1" id="998a32ed-f617-482c-a3ce-1a22a8bc75e4" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html; charset=utf-8</con:mediaType>
          <con:status>400 500</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:ip="https://apisix/ip">ip:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/plain; charset=utf-8</con:mediaType>
          <con:status>403 404</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">
              &lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://apisix.127.0.0.1.nip.io:9443</con:endpoint>
          <con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request id="acb0ca18-90bb-4e38-871b-38c7ef64302b" mediaType="application/json"><con:settings/><con:parameters/></con:request>
          <con:originalUri>https://apisix/ip</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        
      </con:method>
      <con:method name="Method 2" id="9ad9254b-8c18-47c1-bbe6-0c4b4f0eb41a" method="GET">
        <con:settings/>
        <con:parameters/>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:head="https://apisix.127.0.0.1.nip.io/headers">head:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/plain; charset=utf-8</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="69fb85c6-8ff9-4507-b8c9-24b9ff5b88f8" mediaType="application/json" sslKeystore="CLIENT_testuser.p12 ">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">
              &lt;xml-fragment/></con:setting>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@strip-whitespaces">false</con:setting>
          </con:settings>
          <con:endpoint>https://apisix.127.0.0.1.nip.io:9443</con:endpoint>
          <con:request/>
          <con:originalUri>https://apisix.127.0.0.1.nip.io/headers</con:originalUri>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:testSuite id="95ae05b2-8c79-4bf8-9411-2b00d912d200" name="cert-auth">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="c496b45b-b681-4f52-b15f-1e3c1b934987" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="testuser" searchProperties="true">
      <con:settings/>
      <con:testStep type="restrequest" name="Happy flow - testuser" id="36acb9b3-3ac4-46fc-88f0-3d565f73dd1a">
        <con:settings/>
        <con:config service="cert-auth" resourcePath="/headers" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Happy flow - testuser" id="f3aadf34-7013-4ec3-ad7f-ee8cbaa6b05d" mediaType="application/json" sslKeystore="CLIENT_testuser.p12">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
              <con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">true</con:setting>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@remove_empty_content">false</con:setting>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@strip-whitespaces">false</con:setting>
            </con:settings>
            <con:endpoint>https://apisix.127.0.0.1.nip.io:9443</con:endpoint>
            <con:request/>
            <con:originalUri>https://apisix/ip</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="4081130d-993c-435c-baba-eb3c4ac03e50" name="Valid HTTP Status Codes">
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Match" id="37785900-a0ec-44b3-9985-97a63a08fb4c" name="JsonPath Match">
              <con:configuration>
                <path>headers.X-Consumer-Username</path>
                <content>testuser</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Match" id="e890b989-3031-49bb-8843-874522bd75c4">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="JsonPath Match" id="fdcbf204-8934-4548-8cc7-2ae49050256f">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="JsonPath Match" id="a0b08f7e-7eb1-4d5e-b225-4ddcf8114268" name="JsonPath Match Forwarded">
              <con:configuration>
                <path>.headers.X-Forwarded-Host</path>
                <content>[apisix.127.0.0.1.nip.io]</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="UnHappy flow - forbidden" id="46df777c-2dae-41fc-9352-8a65539e47f5">
        <con:settings/>
        <con:config service="cert-auth" resourcePath="/anything" methodName="Method 2" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="UnHappy flow - forbidden" id="69fb85c6-8ff9-4507-b8c9-24b9ff5b88f8" mediaType="application/json" sslKeystore="CLIENT_testuser.p12">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">
                &lt;xml-fragment/></con:setting>
            <con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">true</con:setting></con:settings>
            <con:endpoint>https://apisix.127.0.0.1.nip.io:9443</con:endpoint>
            <con:request/>
            <con:originalUri>https://apisix.127.0.0.1.nip.io/headers</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="09a7dab5-49cb-4b61-8cc1-1ffa2c4773cf" name="Valid HTTP Status Codes">
              <con:configuration>
                <codes>403</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Invalid HTTP Status Codes" id="20ebad7d-2850-46f1-940d-fae6e346c069" name="Invalid HTTP Status Codes">
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Match" id="6b21f709-07e6-44e4-960c-37f20059c1fc" name="JsonPath Match">
              <con:configuration>
                <path>.message</path>
                <content>[The consumer_name is forbidden.]</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:setupScript>import com.eviware.soapui.impl.wsdl.support.wss.crypto.CryptoType

// 1. Specify the path to your keystore
def keystorePath = context.expand('${projectDir}') + "/certs/test/keystore/CLIENT_testuser.p12"

// 2. Add a keystore
testRunner.testCase.testSuite.project.wssContainer.addCrypto(keystorePath,"",CryptoType.KEYSTORE) //path, password, cryptoType

// 3. Get the status in the log
log.info(testRunner.testCase.testSuite.project.wssContainer.getCryptoByName("CLIENT_testuser.p12").getStatus()) // specify the name of your keystore</con:setupScript><con:properties>
        <con:property>
          <con:name>client_profile</con:name>
          <con:value>testuser</con:value>
        </con:property>
        <con:property>
          <con:name>testuser_path</con:name>
          <con:value>${projectDir}\certs\test\keystore\client.p12</con:value>
        </con:property>
        <con:property>
          <con:name>testuser_password</con:name>
          <con:value/>
        </con:property>
        <con:property>
          <con:name>testuser_type</con:name>
          <con:value>PKCS12</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:testCase id="8df5fcbc-f9d7-4f29-84ec-d28790129625" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="certuser" searchProperties="true">
      <con:settings/>
      <con:testStep type="restrequest" name="Happy flow - certuser" id="699f1459-c920-4f09-acc2-f7950fd93b0f">
        <con:settings/>
        <con:config service="cert-auth" resourcePath="/anything" methodName="GET localhost/anything" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Happy flow - certuser" id="fb880d5d-498a-4e0a-b93a-f7b0caae8ce4" mediaType="application/json" sslKeystore="BULT_certuser.p12">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            <con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">true</con:setting></con:settings>
            <con:endpoint>https://127.0.0.1.nip.io:9443</con:endpoint>
            <con:request/>
            <con:originalUri>https://localhost/anything</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="60036bdd-8fba-4c50-a9d0-91daa074f513" name="Valid HTTP Status Codes">
              <con:configuration>
                <codes>200
</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Match" id="7c1b0972-b11f-4eaf-a1e2-0863e0c64cfb" name="JsonPath Match">
              <con:configuration>
                <path>.headers.X-Consumer-Username</path>
                <content>[certuser]</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Match" id="f80554d9-775d-4a6c-b701-bef5be323ba2" name="JsonPath Match Host">
              <con:configuration>
                <path>.headers.X-Forwarded-Host</path>
                <content>[127.0.0.1.nip.io]</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="UnHappy flow - certuser" id="8d70f27c-e6ed-4ed7-98f2-acc2822ca203">
        <con:settings/>
        <con:config service="cert-auth" resourcePath="/headers" methodName="Method 2" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="UnHappy flow - certuser" id="04d146d8-9143-4977-9cef-3f7defb17893" mediaType="application/json" sslKeystore="BULT_certuser.p12">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            <con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">true</con:setting><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@strip-whitespaces">false</con:setting></con:settings>
            <con:endpoint>https://127.0.0.1.nip.io:9443</con:endpoint>
            <con:request/>
            <con:originalUri>https://apisix.127.0.0.1.nip.io/headers</con:originalUri>
            <con:assertion type="Invalid HTTP Status Codes" id="9324cd8c-cc37-41f6-b40c-908eec5334d0" name="Invalid HTTP Status Codes">
              <con:configuration>
                <codes>200
</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="Valid HTTP Status Codes" id="4d222faa-64c1-471b-bf5d-82d80e4366a5" name="Valid HTTP Status Codes">
              <con:configuration>
                <codes>403</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Match" id="376cc90e-501a-4b9c-b0c3-991e51325c60" name="JsonPath Match">
              <con:configuration>
                <path>message</path>
                <content>The consumer_name is forbidden.</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:setupScript>import com.eviware.soapui.impl.wsdl.support.wss.crypto.CryptoType

// 1. Specify the path to your keystore
def keystorePath = context.expand('${projectDir}') + "/certs/test/keystore/BULT_certuser.p12"

// 2. Add a keystore
testRunner.testCase.testSuite.project.wssContainer.addCrypto(keystorePath,"Sander",CryptoType.KEYSTORE) //path, password, cryptoType

// 3. Get the status in the log
log.info(testRunner.testCase.testSuite.project.wssContainer.getCryptoByName("BULT_certuser.p12").getStatus()) // specify the name of your keystore</con:setupScript><con:properties/>
    </con:testCase>
    <con:properties/>
  </con:testSuite>
  <con:properties>
    <con:property>
      <con:name>keystorePathCLIENT</con:name>
      <con:value>certs/test/keystore/CLIENT_testuser.p12</con:value>
    </con:property>
    <con:property>
      <con:name>keystorePathBULT</con:name>
      <con:value>certs/test/keystore/BULT_certuser.p12</con:value>
    </con:property>
  </con:properties>
  <con:wssContainer>
    
    
  </con:wssContainer>
  <con:oAuth2ProfileContainer/>
  <con:oAuth1ProfileContainer/>
  <con:sensitiveInformation/>
</con:soapui-project>