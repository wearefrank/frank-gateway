<Configuration
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="../FrankConfig.xsd"
	>
	<Adapter name="HeaderBasedRoutingAdapter">
		<Receiver name="HeaderBasedReceiver">
			<ApiListener
				name="HeaderBasedApiListener"
				uriPattern="header-routing"
				method="POST"
				headerParams="consumer"/>
		</Receiver>
		
		<Pipeline firstPipe="RoutingPipe">
			<!-- Route based on the 'consumer' header value -->
			<IfPipe name="RoutingPipe" 
					getInputFromSessionKey="headers"
					xpathExpression="normalize-space(/headers/header[@name='consumer']) = 'consumer1'"
					thenForwardName="route1" 
					elseForwardName="route2">
				
				<Forward name="route1" path="Consumer1Processor" />
				<Forward name="route2" path="Consumer2Processor" />
			</IfPipe>

			<!-- Process for consumer1 -->
			<EchoPipe name="Consumer1Processor" getInputFromFixedValue="consumer1!"/>

			<!-- Process for consumer2 or any other consumer -->
			<EchoPipe name="Consumer2Processor" getInputFromFixedValue="consumer2!"/>
		</Pipeline>
	</Adapter>
</Configuration>